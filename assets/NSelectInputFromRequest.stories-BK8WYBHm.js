import{d as V,u as i,x as I,w as h,b as r,t as c,f as m,B as N,D as k,m as F,F as T,p as w,o as s}from"./vue.esm-bundler-DLJ_4Uzc.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-eQqs7920.js";const b=V({name:"NSelectInputFromRequest",props:{url:{type:String,required:!0},valueKey:{type:String,required:!0},name:{type:String,required:!0},label:{type:String,default:""},multiple:{type:Boolean,default:!1},modelValue:{type:[String,Array],default:""},accessToken:{type:String,required:!0},method:{type:String,default:"GET"},headers:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:n}){const o=i([]),l=i(e.modelValue),u=i(!0),d=i(null),a=3;let f=0;const y=async()=>{u.value=!0,d.value=null;try{const t=await fetch(e.url,{method:e.method,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.accessToken}`,...e.headers}});if(!t.ok){if(t.status===500&&f<a){f++,setTimeout(y,500);return}throw new Error(`HTTP error ${t.status}`)}const g=await t.json();console.log("Fetched data:",g),o.value=g.map(v=>({id:v[e.valueKey],name:v.name})),console.log("Fetched items:",o.value)}catch(t){d.value=t instanceof Error?t.message:String(t)}finally{u.value=!1}};return I(y),h(()=>e.modelValue,t=>{l.value=t}),h(l,t=>n("update:modelValue",t)),{items:o,selected:l,loading:u,errorMsg:d,props:e}}}),E={class:"n-select-from-request n-input-wrapper"},B=["for"],M=["name","id","multiple","disabled"],$={key:0,value:""},D=["value"],j={key:1},A={key:2,class:"error"};function C(e,n,o,l,u,d){return s(),r("div",E,[e.props.label?(s(),r("label",{key:0,for:e.props.name,class:"n-input__label"},c(e.props.label),9,B)):m("",!0),N(F("select",{class:"n-input__input",name:e.props.name,id:e.props.name,multiple:e.props.multiple,"onUpdate:modelValue":n[0]||(n[0]=a=>e.selected=a),disabled:e.loading},[!e.props.multiple&&!e.selected?(s(),r("option",$,"Please select…")):m("",!0),(s(!0),r(T,null,w(e.items,a=>(s(),r("option",{key:a.id,value:a.id},c(a.name),9,D))),128))],8,M),[[k,e.selected]]),e.loading?(s(),r("p",j,"Loading…")):m("",!0),e.errorMsg?(s(),r("p",A,c(e.errorMsg),1)):m("",!0)])}const K=R(b,[["render",C],["__scopeId","data-v-bc9d6287"]]);b.__docgenInfo={displayName:"NSelectInputFromRequest",exportName:"default",description:"",tags:{},props:[{name:"url",type:{name:"string"},required:!0},{name:"valueKey",type:{name:"string"},required:!0},{name:"name",type:{name:"string"},required:!0},{name:"label",type:{name:"string"},defaultValue:{func:!1,value:"''"}},{name:"multiple",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"modelValue",type:{name:"string|array"},defaultValue:{func:!1,value:"''"}},{name:"accessToken",type:{name:"string"},required:!0},{name:"method",type:{name:"string"},defaultValue:{func:!1,value:"'GET'"}},{name:"headers",type:{name:"object"},defaultValue:{func:!1,value:"{}"}}],events:[{name:"update:modelValue"}],sourceFiles:["/home/runner/work/NovaUI/NovaUI/src/stories/NSelectInputFromRequest/NSelectInputFromRequest.vue"]};const O={title:"NSelectInputFromRequest",component:K,tags:["autodocs"],argTypes:{label:{control:{type:"text"}}},args:{label:"Button"},parameters:{docs:{description:{component:"A description of the component."}}}},p={};var S,_,q;p.parameters={...p.parameters,docs:{...(S=p.parameters)==null?void 0:S.docs,source:{originalSource:"{}",...(q=(_=p.parameters)==null?void 0:_.docs)==null?void 0:q.source}}};const P=["Default"];export{p as Default,P as __namedExportsOrder,O as default};
